---
const { title, defaultOpen = false } = Astro.props;
const id = `collapsible-${Math.random().toString(36).substr(2, 9)}`;
---

<div class="collapsible-section">
  <input 
    type="checkbox" 
    id={id} 
    class="hidden peer" 
    {defaultOpen}
  />
  <label 
    for={id} 
    class="flex items-center justify-between cursor-pointer group px-4 py-3 -mx-3 rounded-lg hover:bg-purple-50 transition-colors mt-4"
    aria-expanded={defaultOpen}
    aria-controls={`${id}-content`}
  >
    <div class="flex items-center space-x-3">
      <h4 class="font-medium text-purple-800 group-hover:text-purple-900 transition-colors">
        {title}
      </h4>
      <svg 
        class="w-4 h-4 text-purple-600 group-hover:text-purple-800 transition-transform duration-200 peer-checked:rotate-180" 
        xmlns="http://www.w3.org/2000/svg" 
        viewBox="0 0 20 20" 
        fill="currentColor"
        aria-hidden="true"
      >
        <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
      </svg>
    </div>
  </label>
  <div 
    id={`${id}-content`}
    class="overflow-hidden transition-all duration-200 max-h-0 peer-checked:max-h-[500px]"
  >
    <div class="pt-1 pl-3">
      <slot />
    </div>
  </div>
</div>

<style>
  .collapsible-section input[type="checkbox"]:checked + label {
    @apply bg-purple-50;
  }
  .collapsible-section input[type="checkbox"]:focus + label {
    @apply ring-2 ring-purple-500 ring-offset-2;
  }
  .collapsible-section label:hover {
    @apply bg-purple-50;
  }
</style>
